<div id="board">
    {{ $board := .UserBoard }}

    {{ if eq .IsGameOver true }}
        {{ $board = .RealBoard }}
    {{ else }}
        {{ $board = .UserBoard }}
    {{ end }}

    <p>Moves left: {{ .MovesLeft }}</p>

    <table>
        {{ range $iIndex,$iValue := $board }}
        {{ if eq $iIndex 0 }}
            <tr>
                {{ range $jIndex,$jValue := . }}
                    {{ if eq $jIndex 0 }}
                        <th class="mine-field"></th>
                        <th class="mine-field">{{ $jIndex }}</th>
                    {{ else }}
                        <th class="mine-field">{{ $jIndex }}</th>
                    {{ end }}
                {{ end }}
            </tr>
        {{ end }}
            <tr>                
                <th class="mine-field">{{ $iIndex }}</th>

            {{ range $jIndex,$jValue := . }}
                <th class="myClass-{{ $jValue }} mine-field" style="cursor: pointer;border: 2px outset #ececec;" hx-get="boardclick/{{ $iIndex }}/{{ $jIndex }}" hx-target="#board" hx-swap="outerHTML">
                    {{ if eq $jValue -1 }}☠{{ end }}
                    {{ if eq $jValue 0 }} {{ end }}
                    {{ if eq $jValue 1 }}1{{ end }}
                    {{ if eq $jValue 2 }}2{{ end }}
                    {{ if eq $jValue 3 }}3{{ end }}
                    {{ if eq $jValue 4 }}4{{ end }}
                    {{ if eq $jValue 5 }}5{{ end }}
                    {{ if eq $jValue 6 }}6{{ end }}
                    {{ if eq $jValue 7 }}7{{ end }}
                    {{ if eq $jValue 8 }}8{{ end }}
                    {{ if eq $jValue -3 }} {{ end }}
                </th>
            {{ end }}
            </tr>
        {{ end }}
    </table>

    {{ if eq .IsGameOver true}}
        <p>Game Over</p>
        {{ if .IsWon}}
            <dialog id="dialog" style="position: relative; background: aquamarine;">
                <h1>YOU WON!</h1>
                <form method="dialog">
                    <button>OK</button>
                </form>
            </dialog>
        {{end}}
        {{ if .IsLost}}
            <dialog id="dialog" style="position: relative; background: orangered; color: white;">
                <h1>☠ YOU LOSE! ☠</h1>
                <form method="dialog">
                    <button>OK</button>
                </form>
            </dialog>
        {{end}}

        <script>
            var dialog = document.querySelector("dialog")
            dialog.showModal() // Opens a modal
        </script>
    {{ end }}
</div>